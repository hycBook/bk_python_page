---
title: pythonå¸¸ç”¨åº“å­¦ä¹ 
date: '2023/3/12 18:50:25'
top_img: 'https://pic.hycbook.com/i/hexo/post_imgs/è•¾å§†10.webp'
cover: 'https://pic.hycbook.com/i/hexo/post_cover/è•¾å§†10.webp'
categories:
  - python
tags:
  - python
  - å›¾åƒå¤„ç†
abbrlink: 31546
---

---



# å›¾åƒç›¸å…³

> [10ä¸ªPythonå›¾åƒå¤„ç†å·¥å…·ï¼Œéå¸¸å…¨äº†ï¼](https://mp.weixin.qq.com/s?__biz=MzU0NjgzMDIxMQ==&mid=2247593491&idx=5&sn=f43665688909403116957637be1fba2e&chksm=fb548cffcc2305e953c6e20f6e875ef98fd24382d76477366750c5312bd8c474f31c07602ffd&scene=27)

å›¾åƒçš„RGB è‰²å½©æ¨¡å¼

RGB ä¸‰ä¸ªé¢œè‰²é€šé“çš„å˜åŒ–å’Œå åŠ å¾—åˆ°å„ç§é¢œè‰²ï¼Œå…¶ä¸­

- R çº¢è‰²ï¼Œå–å€¼èŒƒå›´ï¼Œ0-255
- G ç»¿è‰²ï¼Œå–å€¼èŒƒå›´ï¼Œ0-255
- B è“è‰²ï¼Œå–å€¼èŒƒå›´ï¼Œ0-255

ä¸€å¹…å›¾åƒä¸Šçš„æ‰€æœ‰åƒç´ ç‚¹çš„ä¿¡æ¯å°±å®Œå…¨å¯ä»¥é‡‡ç”¨çŸ©é˜µæ¥è¡¨ç¤ºï¼Œé€šè¿‡çŸ©é˜µçš„è¿ç®—å®ç°æ›´åŠ å¤æ‚çš„æ“ä½œ

> ç½‘ç»œå›¾ç‰‡è¯»å–

```python
def get_url_img_io(url: str) -> BytesIO:
    """ è·å–ç½‘ç»œå›¾ç‰‡çš„ioæµ """
    return BytesIO(requests.get(url).content)


def get_url_img(url: str):
    """ è·å–ç½‘ç»œå›¾ç‰‡,å¹¶è½¬ä¸ºnp.array """
    return np.asarray(bytearray(get_url_img_io(url).read()), dtype="uint8")
```

- `plt.imshow()`å‡½æ•°è´Ÿè´£å¯¹å›¾åƒè¿›è¡Œå¤„ç†ï¼Œå¹¶æ˜¾ç¤ºå…¶æ ¼å¼
- `plt.show()`åˆ™æ˜¯å°†plt.imshow()å¤„ç†åçš„å‡½æ•°æ˜¾ç¤ºå‡ºæ¥

## PIL

Pythonå›¾åƒåº“ï¼ˆ[PIL(Python Image Library)](https://pillow.readthedocs.io/en/latest/)ï¼‰æ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹PythonåŒ…ï¼Œä¸ºPythonè§£é‡Šå™¨æ·»åŠ äº†å›¾åƒå¤„ç†åŠŸèƒ½ï¼Œå…è®¸å¤„ç†ç…§ç‰‡å¹¶æ‰§è¡Œè®¸å¤šå¸¸è§çš„å›¾åƒæ–‡ä»¶æ“ä½œï¼Œ[å®˜æ–¹æ•™ç¨‹](https://pillow.readthedocs.io/en/latest/handbook/tutorial.html)

> æ‰“å¼€å›¾åƒï¼šè¿”å›ä¸€ä¸ªPIL.JpegImagePlugin.JpegImageFileå¯¹è±¡

```python
# å¯¼å…¥ Image æ¨¡å—
import requests
from PIL import Image

# å›¾åƒè·¯å¾„
img_path = r'frame.jpg'
img_url = r'https://pic.hycbook.com/i/hexo/post_cover/è•¾å§†10.webp'

# æ‰“å¼€æœ¬åœ°å›¾ç‰‡  RGB
im = Image.open(img_path) # JpegImageFile image mode=RGB size=1408x1152

# æ‰“å¼€ç½‘ç»œå›¾ç‰‡
img = Image.open(get_url_img_io(img_url))   # [H,W,C]
```

> JpegImageFileå¯¹è±¡å¸¸ç”¨æ–¹æ³•

```python
import matplotlib.pyplot as plt

# Returns a histogram for the image
histogram = image.histogram()
# å¯è§†åŒ–é¢œè‰²åˆ†å¸ƒç›´æ–¹å›¾
plt.hist(histogram, bins=len(histogram))
plt.xlabel('Histogram')
plt.show()

# è£å‰ªå›¾åƒ  ç”¨äºè£å‰ªçš„å¼€å§‹å’Œç»“æŸx/yåæ ‡
# ç”¨äºè£å‰ªçš„åæ ‡å°†éšç…§ç‰‡è€Œå˜åŒ–ã€‚äº‹å®ä¸Šï¼Œå¯èƒ½åº”è¯¥æ›´æ”¹æ­¤ä»£ç ï¼Œä½¿å…¶æ¥å—è£å‰ªåæ ‡ä½œä¸ºå‚æ•°ã€‚å¯ä»¥è‡ªå·±åå¤å°è¯•ï¼Œæ‰¾å‡ºè¦ä½¿ç”¨çš„è£å‰ªè¾¹ç•Œæ¡†ã€‚å¯ä»¥ä½¿ç”¨åƒGimpè¿™æ ·çš„å·¥å…·æ¥å¸®åŠ©ä½ ï¼Œç”¨Gimpç»˜åˆ¶ä¸€ä¸ªè¾¹ç•Œæ¡†ï¼Œå¹¶è®°ä¸‹å®ƒç»™ä½ çš„åæ ‡ï¼Œæ–¹ä¾¿å°è¯•ä½¿ç”¨Pillow
cropped = image.crop((40, 590, 979, 1500))

# é‡æ–°è°ƒæ•´å›¾åƒå¤§å°
img = im.resize((240,240))

# å›¾åƒæ—‹è½¬
img.rotate(90).show()
```

> ä½¿ç”¨è¿‡æ»¤å™¨ï¼šPillowåŒ…å«æœ‰å‡ ä¸ªè¿‡æ»¤å™¨ï¼Œå¯ä»¥å°†å…¶åº”ç”¨äºå›¾åƒã€‚ä»¥ä¸‹æ˜¯å½“å‰æ”¯æŒçš„ç­›é€‰å™¨

1. BLUR
2. CONTOUR
3. DETAIL
4. EDGE_ENHANCE
5. EDGE_ENHANCE_MORE
6. EMBOSS
7. FIND_EDGES
8. SHARPEN
9. SMOOTH
10. SMOOTH_MORE

```python
from PIL import ImageFilter

blurred_image = image.filter(ImageFilter.BLUR)
```

> æ˜¾ç¤ºå›¾ç‰‡

```python
# æ‰“å¼€å›¾ç‰‡
im = Image.open(img_path)
# æ˜¾ç¤ºå›¾ç‰‡
im.show()
```

> ä¿å­˜å›¾åƒ

```python
infile = "in.jpg"
outfile = "output.jpg"
with Image.open(infile) as im:
	im.save(outfile)
```

> ç±»å‹è½¬æ¢

```python
# JpegImageFile -> np.array  [H,W,C]
np.asanyarray(im)

# np.array -> JpegImageFile
img = Image.fromarray(arr)
```

## cv2

åœ¨è®¡ç®—æœºè§†è§‰é¡¹ç›®çš„å¼€å‘ä¸­ï¼Œ[OpenCV](https://docs.opencv.org/4.x/)ä½œä¸ºè¾ƒå¤§ä¼—çš„å¼€æºåº“ï¼Œæ‹¥æœ‰äº†ä¸°å¯Œçš„å¸¸ç”¨å›¾åƒå¤„ç†å‡½æ•°åº“ï¼Œé‡‡ç”¨C/C++è¯­è¨€ç¼–å†™ï¼Œå¯ä»¥è¿è¡Œåœ¨Linux/Windows/Macç­‰æ“ä½œç³»ç»Ÿä¸Šï¼Œèƒ½å¤Ÿå¿«é€Ÿçš„å®ç°ä¸€äº›å›¾åƒå¤„ç†å’Œè¯†åˆ«çš„ä»»åŠ¡ã€‚æ­¤å¤–ï¼ŒOpenCVè¿˜æä¾›äº†Javaã€pythonã€cudaç­‰çš„ä½¿ç”¨æ¥å£ã€æœºå™¨å­¦ä¹ çš„åŸºç¡€ç®—æ³•è°ƒç”¨ï¼Œä»è€Œä½¿å¾—å›¾åƒå¤„ç†å’Œå›¾åƒåˆ†æå˜å¾—æ›´åŠ æ˜“äºä¸Šæ‰‹ï¼Œè®©å¼€å‘äººå‘˜æ›´å¤šçš„ç²¾åŠ›èŠ±åœ¨ç®—æ³•çš„è®¾è®¡ä¸Š

> æ‰“å¼€å›¾åƒï¼š`cv2.imread(filepath, flags)`ï¼Œè¿”å›ä¸€ä¸ªnp.arrayå¯¹è±¡
>
> flagsï¼šè¯»å…¥å›¾ç‰‡çš„æ ‡å¿—
>
> * cv2.IMREAD_COLORï¼šé»˜è®¤å‚æ•°ï¼Œè¯»å…¥ä¸€å‰¯å½©è‰²å›¾ç‰‡ï¼Œå¿½ç•¥alphaé€šé“
> * cv2.IMREAD_GRAYSCALEï¼šè¯»å…¥ç°åº¦å›¾ç‰‡
> * cv2.IMREAD_UNCHANGEDï¼šé¡¾åæ€ä¹‰ï¼Œè¯»å…¥å®Œæ•´å›¾ç‰‡ï¼ŒåŒ…æ‹¬alphaé€šé“

```python
# å›¾åƒè·¯å¾„
img_path = r'frame.jpg'
img_url = r'https://pic.hycbook.com/i/hexo/post_cover/è•¾å§†10.webp'

# æ‰“å¼€ç½‘ç»œå›¾ç‰‡
img = get_url_img(img_url)

# æ‰“å¼€æœ¬åœ°å›¾ç‰‡
image = cv2.imread(img_path)  # [H,W,C]  np.array
```

> æ‰“å¼€è§†é¢‘





> å¸¸è§æ“ä½œ
>
> `resize`:
>
> cv2.resize(InputArray src, OutputArray dst, Size, fx, fy, interpolation)
>
> | fx, fy        | æ²¿xè½´ï¼Œyè½´çš„ç¼©æ”¾ç³»æ•° |
> | ------------- | -------------------- |
> | interpolation | æ’å…¥æ–¹å¼             |
>
> | INTER_NEAREST  | æœ€è¿‘é‚»æ’å€¼                   |
> | :------------- | :--------------------------- |
> | INTER_LINEAR   | åŒçº¿æ€§æ’å€¼ï¼ˆé»˜è®¤è®¾ç½®ï¼‰       |
> | INTER_AREA     | ä½¿ç”¨åƒç´ åŒºåŸŸå…³ç³»è¿›è¡Œé‡é‡‡æ ·ã€‚ |
> | INTER_CUBIC    | 4x4åƒç´ é‚»åŸŸçš„åŒä¸‰æ¬¡æ’å€¼      |
> | INTER_LANCZOS4 | 8x8åƒç´ é‚»åŸŸçš„Lanczosæ’å€¼     |

```python
img_test = cv2.resize(img, (0, 0), fx=0.25, fy=0.25, interpolation=cv2.INTER_NEAREST)
img_test = cv2.resize(img_test, (0, 0), fx=4, fy=4, interpolation=cv2.INTER_NEAREST)
```

RGBè½¬ç°åº¦ï¼š

```python
img2 = cv2.cvtColor(img, cv2.COLOR_RGB2GRAY)
```

ç°åº¦è½¬RBGï¼š

```python
img3 = cv2.cv2Color(img, cv2.COLOR_GRAY2RGB)
```



> æ˜¾ç¤ºå›¾ç‰‡

```python
cv2.imshow("local pic", image)
cv2.waitKey(0)
```

> ä¿å­˜å›¾åƒ

```python
cv2.imwrite(outfile, image)
```



# æ—¶é—´ç›¸å…³åº“

åè°ƒä¸–ç•Œæ—¶(Coordinated Universal Time, UTC)æ˜¯ä¸€ç§æ ‡å‡†çš„æ—¶é—´è¡¨è¿°æ–¹å¼ï¼Œå®ƒä¸æ—¶åŒºæ— å…³

æœ‰äº›è®¡ç®—æœºï¼Œç”¨æŸæ—¶åˆ»ä¸UNIXæ—¶é—´åŸç‚¹ä¹‹é—´ç›¸å·®çš„ç§’æ•°ï¼Œæ¥è¡¨ç¤ºé‚£ä¸ªæ—¶åˆ»æ‰€å¯¹åº”çš„æ—¶é—´
å¯¹äºè¿™äº›è®¡ç®—æœºæ¥è¯´ï¼ŒUTCæ˜¯ä¸€ç§éå¸¸å¥½çš„è®¡æ—¶æ–¹å¼

> Pythonæä¾›äº†ä¸¤ç§æ—¶é—´è½¬æ¢æ–¹å¼

* æ—§çš„æ–¹å¼ï¼Œæ˜¯ä½¿ç”¨å†…ç½®çš„timeæ¨¡å—ï¼Œè¿™æ˜¯ä¸€ç§ææ˜“å‡ºé”™çš„æ–¹å¼

* æ–°çš„æ–¹å¼ï¼Œåˆ™æ˜¯é‡‡ç”¨å†…ç½®çš„datetimeæ¨¡å—ï¼Œè¯¥æ¨¡å—çš„æ•ˆæœéå¸¸å¥½

> **å°ç»“**ï¼š

* timeæ¨¡å—éœ€è¦ä¾èµ–æ“ä½œç³»ç»Ÿè€Œè¿ä½œã€‚è¯¥æ¨¡å—çš„å®é™…è¡Œä¸ºï¼Œå–å†³äºåº•å±‚çš„Cå‡½æ•°å¦‚ä½•ä¸å®¿ä¸»æ“ä½œç³»ç»Ÿç›¸äº¤äº’

* è¿™ç§å·¥ä½œæ–¹å¼ï¼Œä½¿å¾—timeæ¨¡å—çš„åŠŸèƒ½ä¸å¤Ÿç¨³å®šã€‚å®ƒæ— æ³•åè°ƒåœ°å¤„ç†å„ç§æœ¬åœ°æ—¶åŒºï¼Œå› æ­¤ï¼Œæˆ‘ä»¬åº”è¯¥å°½é‡å°‘ç”¨è¿™ä¸ªæ¨¡å—

å¦‚æœä¸€å®šè¦ä½¿ç”¨timeæ¨¡å—ï¼Œé‚£å°±åªåº”è¯¥ç”¨å®ƒåœ¨UTCä¸å®¿ä¸»è®¡ç®—æœºçš„å½“åœ°æ—¶åŒºä¹‹é—´è¿›è¡Œè½¬æ¢

å¯¹äºå…¶ä»–ç±»å‹çš„è½¬æ¢æ¥è¯´ï¼Œè¿˜æ˜¯ä½¿ç”¨datetimeæ¨¡å—æ¯”è¾ƒå¥½

> å¸¸è§çš„æ—¶é—´æ¨¡å—

* **time**: Pythonå†…ç½®æ—¶é—´åº“ï¼Œé€šè¿‡æ—¶é—´æˆ³æˆ–å…ƒç»„è¡¨ç¤ºæ—¶é—´ï¼ŒåŠŸèƒ½ç®€çº¦ä½†å®ç”¨
* **datetime**: å†…ç½®æ—¥æœŸåº“ï¼Œå¤„ç†æ—¥æœŸæ—¶é—´å¯¹è±¡å’Œå±æ€§
* **dateutil**: åŸºäºdatetimeåº“çš„å®ç”¨æ‹“å±•ï¼Œå¢å¼ºäº†å¯¹æ—¶é—´é—´éš”å’Œæ—¶é—´åºåˆ—çš„å¤„ç†

![time_datetiime](https://pic.hycbook.com/i/hexo/bk_resources/python/14.pythonåŸºç¡€çŸ¥è¯†/time_datetiime.svg)

## timeåº“çš„ä½¿ç”¨

> [ `time`â€” Time access and conversions](https://docs.python.org/3.5/library/time.html#module-time)

> timeåº“æ˜¯Pythonä¸­å¤„ç†æ—¶é—´çš„æ ‡å‡†åº“

* è®¡ç®—æœºæ—¶é—´çš„è¡¨è¾¾

* æä¾›è·å–ç³»ç»Ÿæ—¶é—´å¹¶æ ¼å¼åŒ–è¾“å‡ºåŠŸèƒ½

* æä¾›ç³»ç»Ÿçº§ç²¾ç¡®è®¡æ—¶åŠŸèƒ½ï¼Œç”¨äºç¨‹åºæ€§èƒ½åˆ†æ

> æ—¶é—´è·å–

```python
# è·å–å½“å‰æ—¶é—´æˆ³ï¼Œå³è®¡ç®—æœºå†…éƒ¨æ—¶é—´å€¼ï¼Œæµ®ç‚¹æ•°
>>>time.time()
1568506809.169575

# è·å–å½“å‰æ—¶é—´å¹¶ä»¥æ˜“è¯»æ–¹å¼è¡¨ç¤ºï¼Œè¿”å›å­—ç¬¦ä¸², å°† gmtime()æˆ–localtime() è¿”å›çš„ è¡¨ç¤ºæ—¶é—´çš„ å…ƒç»„æˆ–struct_time è½¬æ¢æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ ¼å¼ï¼š'Sun Jun 20 23:21:051993'ã€‚
>>>time.ctime()  # ç­‰ä»·äº time.asctime(time.localtime(time.time()))
'Sun Sep 15 08:20:16 2019'

# è·å–å½“å‰æ—¶é—´ï¼Œè¡¨ç¤ºä¸ºè®¡ç®—æœºå¯å¤„ç†çš„æ—¶é—´æ ¼å¼ï¼Œè¿”å›çš„æ—¶é—´æ˜¯ä¸¤ä¸ªæ—¶åŒºå¯¹ç›¸åŒæ—¶åˆ»çš„æ—¶é—´è¡¨ç¤º
# è¿”å›çš„æ˜¯struct_timeæ ¼å¼ï¼Œæ˜¯tupleçš„å­ç±»
>>>time.gmtime()  # 0æ—¶åŒº:time.gmtime() æœ¬åœ°æ—¶åŒº:time.localtime(seconds=None)
time.struct_time(tm_year=2019, tm_mon=9, tm_mday=15, tm_hour=0, tm_min=21, tm_sec=40, tm_wday=6, tm_yday=258, tm_isdst=0)

# time.mktime(t)æ˜¯localtime()çš„åå‡½æ•°
>>>time.mktime(time.localtime())
1568508316.0
```

> struct_timeå…ƒç»„çš„å±æ€§å¦‚ä¸‹

| åºå· | å±æ€§     | å€¼                                   |
| ---- | -------- | ------------------------------------ |
| 0    | tm_year  | 2008                                 |
| 1    | tm_mon   | 1 åˆ° 12                              |
| 2    | tm_mday  | 1 åˆ° 31                              |
| 3    | tm_hour  | 0 åˆ° 23                              |
| 4    | tm_min   | 0 åˆ° 59                              |
| 5    | tm_sec   | 0 åˆ° 61 (60æˆ–61 æ˜¯é—°ç§’)              |
| 6    | tm_wday  | 0åˆ°6 (0æ˜¯å‘¨ä¸€)                       |
| 7    | tm_yday  | 1 åˆ° 366(å„’ç•¥å†)                     |
| 8    | tm_isdst | -1, 0, 1, -1æ˜¯å†³å®šæ˜¯å¦ä¸ºå¤ä»¤æ—¶çš„æ——å¸œ |

> æ—¶é—´æ ¼å¼åŒ–

* å¯¹è±¡è½¬å­—ç¬¦ä¸²: `time.strftime(format, obj)`
* å­—ç¬¦ä¸²è½¬ç»“æ„åŒ–: `time.strptime(time_str, format)`

```python
# strftime(tpl, ts)
# tplæ˜¯æ ¼å¼åŒ–æ¨¡æ¿å­—ç¬¦ä¸²ï¼Œç”¨æ¥å®šä¹‰è¾“å‡ºæ•ˆæœ
# tsæ˜¯è®¡ç®—æœºå†…éƒ¨æ—¶é—´ç±»å‹å˜é‡
>>>t = time.gmtime()
>>>time.strftime("%Y-%m-%d %H:%M:%S", t)
'2019-09-15 00:24:23'

# strptime(str, tpl)
# stræ˜¯å­—ç¬¦ä¸²å½¢å¼çš„æ—¶é—´å€¼
# tplæ˜¯æ ¼å¼åŒ–æ¨¡æ¿å­—ç¬¦ä¸²ï¼Œç”¨æ¥å®šä¹‰è¾“å…¥æ•ˆæœ
>>>timeStr = '2018-01-26 12:55:20'
>>>time.strptime(timeStr, "%Y-%m-%d %H:%M:%S")
time.struct_time(tm_year=2019, tm_mon=9, tm_mday=15, tm_hour=0, tm_min=25, tm_sec=50, tm_wday=6, tm_yday=258, tm_isdst=-1)

# ç»“æ„åŒ–å¯¹è±¡è½¬æ—¶é—´æˆ³
>>>time.mktime(time.localtime())
1668562455.0
# æ—¶é—´æˆ³è½¬ç»“æ„åŒ–å¯¹è±¡
>>>time.localtime(time.time())
time.struct_time(tm_year=2022, tm_mon=11, tm_mday=16, tm_hour=9, tm_min=37, tm_sec=9, tm_wday=2, tm_yday=320, tm_isdst=0)
```

* å¸¸ç”¨æ ¼å¼(å¹´æœˆæ—¥ã€æ—¶åˆ†ç§’)

  | æ ¼å¼åŒ–å­—ç¬¦ä¸² | æ—¥æœŸ/æ—¶é—´è¯´æ˜  | å€¼èŒƒå›´å’Œå®ä¾‹                   |
  | ------------ | -------------- | ------------------------------ |
  | %Y           | å¹´ä»½           | 0000~9999ï¼Œä¾‹å¦‚ï¼š1900          |
  | %y           | å»æ‰ä¸–çºªçš„å¹´ä»½ | 00~99                          |
  | %m           | æœˆä»½           | 01~12ï¼Œä¾‹å¦‚ï¼š10                |
  | %B           | æœˆä»½åç§°       | January~Decemberï¼Œä¾‹å¦‚ï¼šApril  |
  | %b           | æœˆä»½åç§°ç¼©å†™   | Jan~Decï¼Œä¾‹å¦‚ï¼šApr             |
  | %H           | å°æ—¶ï¼ˆ24håˆ¶ï¼‰  | 00~23ï¼Œä¾‹å¦‚ï¼š12                |
  | %h           | å°æ—¶ï¼ˆ12håˆ¶ï¼‰  | 01~12ï¼Œä¾‹å¦‚ï¼š7                 |
  | %M           | åˆ†é’Ÿ           | 00~59ï¼Œä¾‹å¦‚ï¼š26                |
  | %S           | ç§’             | 00~59ï¼Œä¾‹å¦‚ï¼š26                |

* å…¶ä»–æ ¼å¼

  | æ ¼å¼åŒ–å­—ç¬¦ä¸² | æ—¥æœŸ/æ—¶é—´è¯´æ˜        | å€¼èŒƒå›´å’Œå®ä¾‹                   |
  | ------------ | -------------------- | ------------------------------ |
  | %w           | æ˜ŸæœŸä¸­çš„ç¬¬å‡ å¤©       | 0~6ï¼Œ0å¯¹åº”æ˜ŸæœŸå¤©               |
  | %d           | æ—¥æœŸï¼Œä¸€æœˆä¸­çš„ç¬¬å‡ å¤© | 01~31ï¼Œä¾‹å¦‚ï¼š25                |
  | %j           | ä¸€å¹´ä¸­çš„ç¬¬å‡ å¤©       | 001~366                        |
  | %A           | æ˜ŸæœŸ                 | Monday~Sundayï¼Œä¾‹å¦‚ï¼šWednesday |
  | %a           | æ˜ŸæœŸç¼©å†™             | Mon~Sunï¼Œä¾‹å¦‚ï¼šWed             |
  | %p           | ä¸Š/ä¸‹åˆ              | AM, PMï¼Œä¾‹å¦‚ï¼šPM               |
  | %Z           | æ—¶åŒºçš„åå­—           |                                |

å°†æ—¶é—´ä»¥åˆç†çš„æ–¹å¼å±•ç¤ºå‡ºæ¥

- æ ¼å¼åŒ–ï¼šç±»ä¼¼å­—ç¬¦ä¸²æ ¼å¼åŒ–ï¼Œéœ€è¦æœ‰å±•ç¤ºæ¨¡æ¿
- å±•ç¤ºæ¨¡æ¿ç”±ç‰¹å®šçš„æ ¼å¼åŒ–æ§åˆ¶ç¬¦ç»„æˆ
- strftime()æ–¹æ³•

> ç¨‹åºè®¡æ—¶: æµ‹é‡èµ·æ­¢åŠ¨ä½œæ‰€ç»å†æ—¶é—´çš„è¿‡ç¨‹

* æµ‹é‡æ—¶é—´ï¼šperf_counter()

* äº§ç”Ÿæ—¶é—´ï¼šsleep()

```python
# è¿”å›ä¸€ä¸ªCPUçº§åˆ«çš„ç²¾ç¡®æ—¶é—´è®¡æ•°å€¼ï¼Œå•ä½ä¸ºç§’
# ç”±äºè¿™ä¸ªè®¡æ•°å€¼èµ·ç‚¹ä¸ç¡®å®šï¼Œè¿ç»­è°ƒç”¨å·®å€¼æ‰æœ‰æ„ä¹‰
>>>start = time.perf_counter()
318.66599499718114
>>>end = time.perf_counter()
341.3905185375658
>>>end - start
22.724523540384666

# sæ‹Ÿä¼‘çœ çš„æ—¶é—´ï¼Œå•ä½æ˜¯ç§’ï¼Œå¯ä»¥æ˜¯æµ®ç‚¹æ•°
time.sleep(5)
```

## datetime æ¨¡å—

python å¤„ç†æ—¥æœŸå’Œæ—¶é—´çš„æ ‡å‡†åº“ï¼Œå¸¸ç”¨ datetime ç±»ï¼ŒåŠ date ç±» å’Œ time ç±»ï¼Œå¯åšè®¡ç®—ä¹‹ç±»çš„æ“ä½œ

timeæ¨¡å—æ¯”è¾ƒåº•å±‚ï¼Œèƒ½å®Œæˆçš„åŠŸèƒ½ç›¸å¯¹æœ‰é™ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦æ›´é«˜çº§çš„datetimeæ¨¡å—æ¥å‚ä¸äº†

å¯ä»¥ç®€å•ç†è§£ä¸ºï¼Œdatetimeæ¨¡å—æ˜¯å¯¹timeæ¨¡å—è¿›è¡Œäº†æ›´é«˜ä¸€å±‚çš„å°è£…

> åŸºæœ¬å®šä¹‰å’Œå±æ€§æ–¹æ³•

```python
import datetime
import sys
from typing import Tuple
from dateutil import relativedelta
from dateutil.parser import parse


def fn_basic() -> Tuple:
    """ åŸºæœ¬å®šä¹‰å’Œå±æ€§æ–¹æ³• """
    # è·å–å½“å‰æ—¥æœŸæ—¶é—´
    d_now = datetime.datetime.now()  # ç­‰ä»·äºdatetime.datetime.today()
    d_utc_now = datetime.datetime.utcnow()  # è·å–utcå¯¹è±¡, åŒ—äº¬æ—¶é—´+8h=d_utc_now
    # è‡³å°‘è¦ç»™å®šå¹´æœˆæ—¥
    d_free = datetime.datetime(year=2022, month=11, day=11)
    print("d_now ", d_now)
    print(f"d_nowçš„è¯¦ç»†ä¿¡æ¯: year:{d_now.year} month:{d_now.month} day:{d_now.day}")
    print(f"d_nowçš„è¯¦ç»†ä¿¡æ¯: hour:{d_now.hour} minute:{d_now.minute} second:{d_now.second} microsecond:{d_now.microsecond}")
    print("d_free", d_free)
    # å¸¸ç”¨å±æ€§
    d = d_free.date()  # è·å–æ—¥æœŸå¯¹è±¡
    t = d_free.time()  # è·å–æ—¶é—´å¯¹è±¡
    dt = datetime.datetime.combine(date=d, time=t)  # æ ¹æ®dateå’Œtime, åˆ›å»ºä¸€ä¸ªdatetimeå¯¹è±¡
    ts = d_free.timestamp()  # è·å–å¯¹è±¡çš„æ—¶é—´æˆ³
    print("ts    ", ts)
    print(sys._getframe().f_code.co_name, "=" * 60, '\n')
    return d_now, d_free

# è¾“å‡º
d_now  2022-11-15 16:59:45.447093
d_nowçš„è¯¦ç»†ä¿¡æ¯: year:2022 month:11 day:15
d_nowçš„è¯¦ç»†ä¿¡æ¯: hour:16 minute:59 second:45 microsecond:447093
d_free 2022-11-11 00:00:00
ts     1668096000.0
fn_basic ============================================================ 
```

> æ—¥æœŸæ—¶é—´å·®å¼‚

```python
def fn_dif(d_now, d_free):
    """ æ—¥æœŸæ—¶é—´å·®å¼‚ """
    # type(dif) == timedelta
    dif = d_now - d_free
    print("d_free+dif==d_now is", d_free + dif == d_now)

    # ä¸‹ä¸ªæœˆ å‰ä¸€å¤© å¾€å9å°æ—¶ å†å¾€å‰10åˆ†é’Ÿ
    d_dif = d_free + relativedelta.relativedelta(months=1, days=-1, hours=9, minutes=-10)
    print("d_dif ", d_dif)
    # æŒ‡å®šæ—¶é—´ï¼Œåªèƒ½æ˜¯æ•´æ•°
    d_dif_abs = d_free + relativedelta.relativedelta(month=1, day=5, hour=9, minute=10)
    print("d_dif_abs ", d_dif_abs)
    print(sys._getframe().f_code.co_name, "=" * 60, '\n')
   
# è¾“å‡º
d_free+dif==d_now is True
d_dif  2022-12-10 08:50:00
d_dif_abs  2022-01-05 09:10:00
fn_dif ============================================================ 
```

> æ—¥æœŸæ—¶é—´çš„æ ¼å¼åŒ–

```python
def fn_format_transform():
    """ æ—¥æœŸæ—¶é—´çš„æ ¼å¼åŒ– """
    date_format_str = "%Y-%m-%d %H:%M:%S"
    date_format_str_2 = "{:%Y-%m-%d %H:%M:%S}"
    # è·å–å½“å‰æ—¥æœŸæ—¶é—´
    d_now = datetime.datetime.now()

    # å¯¹è±¡è½¬å­—ç¬¦ä¸²
    date_string = d_now.strftime(date_format_str)
    print("date_string:", date_string)
    date_string_2 = date_format_str_2.format(d_now)
    print("date_string_2:", date_string_2)

    # å­—ç¬¦ä¸²è½¬å¯¹è±¡
    d_from_str = datetime.datetime.strptime(date_string, date_format_str)
    print("d_from_str:", d_from_str)
    # dateutil.parse å¯ä»¥è§£æå‡ ä¹æ‰€æœ‰äººç±»èƒ½å¤Ÿç†è§£çš„æ—¥æœŸè¡¨ç¤ºå½¢å¼
    d_parse = parse(date_string)
    print("parse:", d_parse)
    print("parse('Jan 31, 2021 10:45 PM'): ", parse('Jan 31, 2022 10:45 PM'))
    print("parse(str(d_now)): ", parse(str(d_now)))

    print(sys._getframe().f_code.co_name, "=" * 60, '\n')
   
# è¾“å‡º
date_string: 2022-11-15 16:59:45
date_string_2: 2022-11-15 16:59:45
d_from_str: 2022-11-15 16:59:45
parse: 2022-11-15 16:59:45
parse('Jan 31, 2021 10:45 PM'):  2022-01-31 22:45:00
parse(str(d_now)):  2022-11-15 16:59:45.447093
fn_format ============================================================ 
```

>äº§ç”ŸæŒ‡å®šèŒƒå›´å†…çš„æ—¥æœŸæ—¶é—´

```python
def gen_date_times():
    """ äº§ç”ŸæŒ‡å®šèŒƒå›´å†…çš„æ—¥æœŸæ—¶é—´ """

    def date_time(p_start_time, p_end_time, p_format: str = '%Y-%m-%d'):
        while p_start_time < p_end_time:
            select_time = p_start_time.strftime(p_format)
            print(select_time)
            p_start_time += datetime.timedelta(days=1)

    # è·å–å½“å¤©æ—¶é—´
    format_ = '%Y-%m-%d'
    end_time = datetime.datetime.now()
    start_time = end_time + relativedelta.relativedelta(days=-10)
    date_time(p_start_time=start_time, p_end_time=end_time, p_format=format_)

# è¾“å‡º
2022-11-05
2022-11-06
2022-11-07
2022-11-08
2022-11-09
2022-11-10
2022-11-11
2022-11-12
2022-11-13
2022-11-14
2022-11-15
```



## calendaråº“çš„ä½¿ç”¨

> æä¾›ä¸æ—¥å†ç›¸å…³åŠŸèƒ½ï¼Œå¦‚ï¼šä¸ºç»™å®šçš„æœˆä»½æˆ–å¹´ä»½ï¼Œæ‰“å°æ–‡æœ¬æ—¥å†

```python
import calendar
c = calendar.month(2019, 9)
print(c)

   September 2019
Mo Tu We Th Fr Sa Su
                   1
 2  3  4  5  6  7  8
 9 10 11 12 13 14 15
16 17 18 19 20 21 22
23 24 25 26 27 28 29
30

```

# randomåº“çš„ä½¿ç”¨

> randomåº“æ˜¯ä½¿ç”¨éšæœºæ•°çš„Pythonæ ‡å‡†åº“

* ä¼ªéšæœºæ•°: é‡‡ç”¨æ¢…æ£®æ—‹è½¬ç®—æ³•ç”Ÿæˆçš„(ä¼ª)éšæœºåºåˆ—ä¸­å…ƒç´ 

![img](https://pic.hycbook.com/i/hexo/bk_resources/python/14.pythonåŸºç¡€çŸ¥è¯†/1568510165657.webp)
* randomåº“ä¸»è¦ç”¨äºç”Ÿæˆéšæœºæ•°

* ä½¿ç”¨randomåº“: import random

> ä¸»è¦æ–¹æ³•

* åŸºæœ¬éšæœºæ•°å‡½æ•°ï¼š seed(), random()

* æ‰©å±•éšæœºæ•°å‡½æ•°ï¼š randint(), getrandbits(), uniform(), randrange(), choice(), shuffle()

> åŸºæœ¬éšæœºæ•°å‡½æ•°

```python
# åˆå§‹åŒ–ç»™å®šçš„éšæœºæ•°ç§å­ï¼Œé»˜è®¤ä¸ºå½“å‰ç³»ç»Ÿæ—¶é—´
>>>random.seed(10) #äº§ç”Ÿç§å­10å¯¹åº”çš„åºåˆ—
# ç”Ÿæˆä¸€ä¸ª[0.0, 1.0)ä¹‹é—´çš„éšæœºå°æ•°
>>>random.random()
0.5714025946899135

# è¿”å›æ•è·å½“å‰ç”Ÿæˆå™¨å†…éƒ¨çŠ¶æ€çš„å¯¹è±¡.è¯¥å¯¹è±¡å¯ä»¥ç”¨äºå‡½æ•°setstate()å–ä¿å­˜å½“å‰çš„çŠ¶æ€.
>>> state = random.getstate()
>>> random.setstate(state)

# ä»¥ç›¸åŒé¡ºåºæ‰“ä¹±å¤šä¸ªæ•°ç»„
# ç­‰ä»·äº  np.random.get_state()    np.random.shuffle(a)   np.random.set_state(state)
a = np.arange(10)
b=['A','B','C','D','E','F','G','H','I','J']
state=random.getstate()
random.shuffle(a)
print(a)
random.setstate(state)
random.shuffle(b)
print(b)

[9 4 5 0 1 2 6 8 7 3]
['J', 'E', 'F', 'A', 'B', 'C', 'G', 'I', 'H', 'D']

```

> æ‰©å±•éšæœºæ•°å‡½æ•°

```python
# ç”Ÿæˆä¸€ä¸ª[a, b]ä¹‹é—´çš„æ•´æ•°
>>>random.randint(10, 100)
64

# ç”Ÿæˆä¸€ä¸ª[m, n)ä¹‹é—´ä»¥kä¸ºæ­¥é•¿çš„éšæœºæ•´æ•°
>>>random.randrange(10, 100, 10)
80
     
# ç”Ÿæˆä¸€ä¸ªkæ¯”ç‰¹é•¿çš„éšæœºæ•´æ•°
>>>random.getrandbits(16)
37885

# ç”Ÿæˆä¸€ä¸ª[a, b]ä¹‹é—´çš„éšæœºå°æ•°
>>>random.uniform(10, 100)
13.096321648808136

# ä»åºåˆ—seqä¸­éšæœºé€‰æ‹©ä¸€ä¸ªå…ƒç´ 
>>>random.choice([1,2,3,4,5,6,7,8,9])
8

# å°†åºåˆ—seqä¸­å…ƒç´ éšæœºæ’åˆ—ï¼Œè¿”å›æ‰“ä¹±åçš„åºåˆ—
>>> s=[1,2,3,4,5,6,7,8,9];
>>> random.shuffle(s);
>>> print(s)
[3, 5, 8, 9, 6, 1, 2, 7, 4]
```

|         å‡½æ•°         |                   æè¿°                    |
| :------------------: | :---------------------------------------: |
|    randint(a, b)     |         ç”Ÿæˆä¸€ä¸ª[a, b]ä¹‹é—´çš„æ•´æ•°          |
| randrange(m, n[, k]) |   ç”Ÿæˆä¸€ä¸ª[m, n)ä¹‹é—´ä»¥kä¸ºæ­¥é•¿çš„éšæœºæ•´æ•°   |
|    getrandbits(k)    |         ç”Ÿæˆä¸€ä¸ªkæ¯”ç‰¹é•¿çš„éšæœºæ•´æ•°         |
|    uniform(a, b)     |       ç”Ÿæˆä¸€ä¸ª[a, b]ä¹‹é—´çš„éšæœºå°æ•°        |
|     choice(seq)      |        ä»åºåˆ—seqä¸­éšæœºé€‰æ‹©ä¸€ä¸ªå…ƒç´         |
|     shuffle(seq)     | å°†åºåˆ—seqä¸­å…ƒç´ éšæœºæ’åˆ—ï¼Œè¿”å›æ‰“ä¹±åçš„åºåˆ— |

# å‘½ä»¤è¡Œè„šæœ¬ä¼ å‚

> [å‘½ä»¤è¡Œè¿è¡ŒPythonè„šæœ¬æ—¶ä¼ å…¥å‚æ•°çš„ä¸‰ç§æ–¹å¼](https://blog.csdn.net/u012426298/article/details/80263507)

å¦‚æœåœ¨è¿è¡Œpythonè„šæœ¬æ—¶éœ€è¦ä¼ å…¥ä¸€äº›å‚æ•°ï¼Œä¾‹å¦‚`gpus`ä¸`batch_size`ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹ä¸‰ç§æ–¹å¼ã€‚

```cmd
python script.py 0,1,2 10
python script.py --gpus=0,1,2 --batch-size=10
python script.py --gpus=0,1,2 --batch_size=10
```

è¿™ä¸‰ç§æ ¼å¼å¯¹åº”ä¸åŒçš„å‚æ•°è§£ææ–¹å¼ï¼Œåˆ†åˆ«ä¸º`sys.argv`, `argparse`, `tf.app.run`

å‰ä¸¤è€…æ˜¯pythonè‡ªå¸¦çš„åŠŸèƒ½ï¼Œåè€…æ˜¯`tensorflow`æä¾›çš„ä¾¿æ·æ–¹å¼ã€‚

## sys.argv

`sys`æ¨¡å—æ˜¯å¾ˆå¸¸ç”¨çš„æ¨¡å—ï¼Œ å®ƒå°è£…äº†ä¸pythonè§£é‡Šå™¨ç›¸å…³çš„æ•°æ®ï¼Œä¾‹å¦‚`sys.modules`é‡Œé¢æœ‰å·²ç»åŠ è½½äº†çš„æ‰€æœ‰æ¨¡å—ä¿¡æ¯ï¼Œ`sys.path`é‡Œé¢æ˜¯`PYTHONPATH`çš„å†…å®¹ï¼Œè€Œ`sys.argv`åˆ™å°è£…äº†ä¼ å…¥çš„å‚æ•°æ•°æ®

> ä½¿ç”¨`sys.argv`æ¥æ”¶ä¸Šé¢ç¬¬ä¸€ä¸ªå‘½ä»¤ä¸­åŒ…å«çš„å‚æ•°æ–¹å¼å¦‚ä¸‹ï¼š

```python
import sys
gpus = sys.argv[1]
# gpus = [int(gpus.split(','))]
batch_size = sys.argv[2]
print gpus
print batch_size
```

## argparse

> [å®˜æ–¹æ–‡æ¡£](https://docs.python.org/zh-cn/dev/library/argparse.html)
>
> [ä½¿ç”¨argparseä»å‘½ä»¤è¡Œæ¥æ”¶boolç±»å‹çš„å‚æ•°](https://www.jianshu.com/p/7335651ca176)
>
> [Python argparseåº“ç”¨æ³•æ€»ç»“](https://zhuanlan.zhihu.com/p/395173906)

### é€Ÿè§ˆ

```python
import argparse

# åˆ›å»ºä¸€ä¸ªè§£æå¯¹è±¡
parser = argparse.ArgumentParser(prog='æˆ‘çš„è§£æå¯¹è±¡')

# æ·»åŠ ä½ è¦å…³æ³¨çš„å‘½ä»¤è¡Œå‚æ•°å’Œé€‰é¡¹
parser.add_argument('--doc_path', '-dp')
parser.add_argument('-tip', '--tp')

# è§£æå‚æ•°
opt = parser.parse_args()

# å¸¦--çš„å‚æ•°å¯ä»¥ç›´æ¥ç”¨åå­—è®¿é—®
print(opt.tp, opt.doc_path)
```

å¯ä»¥ç”¨`python arg.py -h `è·å–å¸®åŠ©

### ArgumentParser

```python
class argparse.ArgumentParser(prog=None, usage=None, description=None, epilog=None, parents=[], formatter_class=argparse.HelpFormatter, prefix_chars='-', fromfile_prefix_chars=None, argument_default=None, conflict_handler='error', add_help=True, allow_abbrev=True, exit_on_error=True)
```

åˆ›å»ºä¸€ä¸ªæ–°çš„[`ArgumentParser`](https://docs.python.org/zh-cn/dev/library/argparse.html#argparse.ArgumentParser)å¯¹è±¡ï¼Œæ‰€æœ‰çš„å‚æ•°éƒ½åº”å½“ä½œä¸ºå…³é”®å­—å‚æ•°ä¼ å…¥ï¼Œæ¯ä¸ªå‚æ•°åœ¨ä¸‹é¢éƒ½æœ‰å®ƒæ›´è¯¦ç»†çš„æè¿°

* [prog](https://docs.python.org/zh-cn/dev/library/argparse.html#prog) - ç¨‹åºçš„åç§° (é»˜è®¤å€¼: `os.path.basename(sys.argv[0])`)
* [usage](https://docs.python.org/zh-cn/dev/library/argparse.html#usage) - æè¿°ç¨‹åºç”¨é€”çš„å­—ç¬¦ä¸²ï¼ˆé»˜è®¤å€¼ï¼šä»æ·»åŠ åˆ°è§£æå™¨çš„å‚æ•°ç”Ÿæˆï¼‰
* [description](https://docs.python.org/zh-cn/dev/library/argparse.html#description) - åœ¨å‚æ•°å¸®åŠ©æ–‡æ¡£ä¹‹åæ˜¾ç¤ºçš„æ–‡æœ¬ (é»˜è®¤å€¼:æ— )
* [epilog](https://docs.python.org/zh-cn/dev/library/argparse.html#epilog) - Text to display after the argument help (by default, no text)
* [parents](https://docs.python.org/zh-cn/dev/library/argparse.html#parents) - ä¸€ä¸ª [`ArgumentParser`](https://docs.python.org/zh-cn/dev/library/argparse.html#argparse.ArgumentParser) å¯¹è±¡çš„åˆ—è¡¨ï¼Œå®ƒä»¬çš„å‚æ•°ä¹Ÿåº”åŒ…å«åœ¨å†…
* [formatter_class](https://docs.python.org/zh-cn/dev/library/argparse.html#formatter-class) - ç”¨äºè‡ªå®šä¹‰å¸®åŠ©æ–‡æ¡£è¾“å‡ºæ ¼å¼çš„ç±»
  * argparse.**RawDescriptionHelpFormatter**ï¼šè¡¨ç¤º [description](https://docs.python.org/zh-cn/dev/library/argparse.html#description) å’Œ [epilog](https://docs.python.org/zh-cn/dev/library/argparse.html#epilog) å·²ç»è¢«æ­£ç¡®çš„æ ¼å¼åŒ–
  * argparse.**RawTextHelpFormatter**ï¼šä¿ç•™æ‰€æœ‰ç§ç±»æ–‡å­—çš„ç©ºæ ¼ï¼ŒåŒ…æ‹¬å‚æ•°çš„æè¿°
  * argparse.**ArgumentDefaultsHelpFormatter**ï¼šè‡ªåŠ¨æ·»åŠ é»˜è®¤çš„å€¼çš„ä¿¡æ¯åˆ°æ¯ä¸€ä¸ªå¸®åŠ©ä¿¡æ¯çš„å‚æ•°ä¸­:
  * argparse.**MetavarTypeHelpFormatter**ï¼šæ¯ä¸€ä¸ªå‚æ•°ä¸­ä½¿ç”¨ [type](https://docs.python.org/zh-cn/dev/library/argparse.html#type) çš„å‚æ•°åå½“ä½œå®ƒçš„æ˜¾ç¤ºå
* [prefix_chars](https://docs.python.org/zh-cn/dev/library/argparse.html#prefix-chars) - å¯é€‰å‚æ•°çš„å‰ç¼€å­—ç¬¦é›†åˆï¼ˆé»˜è®¤å€¼ï¼š '-'ï¼‰ï¼Œè®¸å¤šå‘½ä»¤è¡Œä¼šä½¿ç”¨ `-` å½“ä½œå‰ç¼€ï¼Œæ¯”å¦‚ `-f/--foo`ã€‚å¦‚æœè§£æå™¨éœ€è¦æ”¯æŒä¸åŒçš„æˆ–è€…é¢å¤–çš„å­—ç¬¦ï¼Œæ¯”å¦‚åƒ `+f` æˆ–è€… `/foo` çš„é€‰é¡¹ï¼Œå¯ä»¥åœ¨å‚æ•°è§£ææ„å»ºå™¨ä¸­ä½¿ç”¨ `prefix_chars=` å‚æ•°
* [fromfile_prefix_chars](https://docs.python.org/zh-cn/dev/library/argparse.html#fromfile-prefix-chars) - å½“éœ€è¦ä»æ–‡ä»¶ä¸­è¯»å–å…¶ä»–å‚æ•°æ—¶ï¼Œç”¨äºæ ‡è¯†æ–‡ä»¶åçš„å‰ç¼€å­—ç¬¦é›†åˆï¼ˆé»˜è®¤å€¼ï¼š `None`ï¼‰
* [argument_default](https://docs.python.org/zh-cn/dev/library/argparse.html#argument-default) - å‚æ•°çš„å…¨å±€é»˜è®¤å€¼ï¼ˆé»˜è®¤å€¼ï¼š `None`ï¼‰
* [conflict_handler](https://docs.python.org/zh-cn/dev/library/argparse.html#conflict-handler) - è§£å†³å†²çªé€‰é¡¹çš„ç­–ç•¥ï¼ˆé€šå¸¸æ˜¯ä¸å¿…è¦çš„ï¼‰
* [add_help](https://docs.python.org/zh-cn/dev/library/argparse.html#add-help) - ä¸ºè§£æå™¨æ·»åŠ ä¸€ä¸ª `-h/--help` é€‰é¡¹ï¼ˆé»˜è®¤å€¼ï¼š `True`ï¼‰ï¼Œæœ‰æ—¶å€™å¯èƒ½ä¼šéœ€è¦å…³é—­é¢å¤–çš„å¸®åŠ©ä¿¡æ¯
* [allow_abbrev](https://docs.python.org/zh-cn/dev/library/argparse.html#allow-abbrev) - å¦‚æœç¼©å†™æ˜¯æ— æ­§ä¹‰çš„ï¼Œåˆ™å…è®¸ç¼©å†™é•¿é€‰é¡¹ ï¼ˆé»˜è®¤å€¼ï¼š`True`ï¼‰
* [exit_on_error](https://docs.python.org/zh-cn/dev/library/argparse.html#exit-on-error) - æ­£å¸¸æƒ…å†µä¸‹ï¼Œå½“ä½ å‘ [`ArgumentParser`](https://docs.python.org/zh-cn/dev/library/argparse.html#argparse.ArgumentParser) çš„ [`parse_args()`](https://docs.python.org/zh-cn/dev/library/argparse.html#argparse.ArgumentParser.parse_args) æ–¹æ³•ä¼ å…¥ä¸€ä¸ªæ— æ•ˆçš„å‚æ•°åˆ—è¡¨æ—¶ï¼Œå®ƒå°†ä¼šé€€å‡ºå¹¶å‘å‡ºé”™è¯¯ä¿¡æ¯ã€‚å¦‚æœç”¨æˆ·æƒ³è¦æ‰‹åŠ¨æ•è·é”™è¯¯ï¼Œå¯é€šè¿‡å°† `exit_on_error` è®¾ä¸º `False` æ¥å¯ç”¨è¯¥ç‰¹æ€§

```python
import argparse


# å®ä¾‹åŒ–
parser = argparse.ArgumentParser(prog="hyc_prog", usage='%(prog)s [options]',
                                 description='[%(prog)s] å‚æ•°è§£ææè¿°ï¼Œç”¨äºæ¼”ç¤º',
                                 epilog="description å‚æ•°åæ˜¾ç¤ºé¢å¤–çš„å¯¹ç¨‹åºçš„æè¿°",
                                 # è¡¨ç¤º description å’Œ epilog å·²ç»è¢«æ­£ç¡®çš„æ ¼å¼åŒ–äº†
                                 formatter_class=argparse.RawDescriptionHelpFormatter,
                                 prefix_chars='-+',  # è§£æå™¨éœ€è¦æ”¯æŒä¸åŒçš„æˆ–è€…é¢å¤–çš„å­—ç¬¦
                                 argument_default=argparse.SUPPRESS, # å…¨å±€ç¦æ­¢åœ¨ parse_args() ä¸­åˆ›å»ºå±æ€§
                                 )

# fromfile_prefix_charså‚æ•°
with open('args.txt', 'w', encoding=sys.getfilesystemencoding()) as fp:
    fp.write('-f\nbar')

parser = argparse.ArgumentParser(fromfile_prefix_chars='@')
parser.add_argument('-f')
parser.parse_args(['-f', 'foo', '@args.txt'])


# conflict_handlerå‚æ•°
parser = argparse.ArgumentParser(prog='PROG', conflict_handler='resolve')
parser.add_argument('-f', '--foo', help='old foo help')
parser.add_argument('--foo', help='new foo help')
parser.print_help()

>>> usage: PROG [-h] [-f FOO] [--foo FOO]
options:
 -h, --help  show this help message and exit
 -f FOO      old foo help
 --foo FOO   new foo help


# exit_on_errorå‚æ•°
parser = argparse.ArgumentParser(exit_on_error=False)
parser.add_argument('--integers', type=int)

try:
    parser.parse_args('--integers a'.split())
except argparse.ArgumentError:
    print('Catching an argumentError')
```

### add_argument

```python
ArgumentParser.add_argument(name or flags...[, action][, nargs][, const][, default][, type][, choices][, required][, help][, metavar][, dest])
```

å®šä¹‰å•ä¸ªçš„å‘½ä»¤è¡Œå‚æ•°åº”å½“å¦‚ä½•è§£æï¼Œæ¯ä¸ªå½¢å‚éƒ½åœ¨ä¸‹é¢æœ‰å®ƒè‡ªå·±æ›´å¤šçš„æè¿°ï¼Œé•¿è¯çŸ­è¯´æœ‰ï¼š

* name or flags - ä¸€ä¸ªå‘½åæˆ–è€…ä¸€ä¸ªé€‰é¡¹å­—ç¬¦ä¸²çš„åˆ—è¡¨ï¼Œä¾‹å¦‚ foo æˆ– -f, --foo
* action - å½“å‚æ•°åœ¨å‘½ä»¤è¡Œä¸­å‡ºç°æ—¶ä½¿ç”¨çš„åŠ¨ä½œåŸºæœ¬ç±»å‹
* nargs - å‘½ä»¤è¡Œå‚æ•°åº”å½“æ¶ˆè€—çš„æ•°ç›®
* const - è¢«ä¸€äº› action å’Œ nargs é€‰æ‹©æ‰€éœ€æ±‚çš„å¸¸æ•°
* default - å½“å‚æ•°æœªåœ¨å‘½ä»¤è¡Œä¸­å‡ºç°å¹¶ä¸”ä¹Ÿä¸å­˜åœ¨äºå‘½åç©ºé—´å¯¹è±¡æ—¶æ‰€äº§ç”Ÿçš„å€¼
* type - å‘½ä»¤è¡Œå‚æ•°åº”å½“è¢«è½¬æ¢æˆçš„ç±»å‹
* choices - A sequence of the allowable values for the argument.
* required - æ­¤å‘½ä»¤è¡Œé€‰é¡¹æ˜¯å¦å¯çœç•¥(ä»…é€‰é¡¹å¯ç”¨)ï¼Œ`åªèƒ½ç”¨äºå¯é€‰å‚æ•°(optional arguments)`
* help - ä¸€ä¸ªæ­¤é€‰é¡¹ä½œç”¨çš„ç®€å•æè¿°
* metavar - åœ¨ä½¿ç”¨æ–¹æ³•æ¶ˆæ¯ä¸­ä½¿ç”¨çš„å‚æ•°å€¼ç¤ºä¾‹
* dest - è¢«æ·»åŠ åˆ°parse_args()æ‰€è¿”å›å¯¹è±¡ä¸Šçš„å±æ€§å

> name or flags

nameå°±æ˜¯æŒ‡å‘½ä»¤è¡Œå‚æ•°ä¸­æ²¡æœ‰'-'çš„å‚æ•°åå­—ä¾‹å¦‚'myname'ï¼Œè€Œflagså°±æ˜¯æŒ‡å‰é¢æœ‰'-'çš„å‚æ•°åï¼Œä¾‹å¦‚'-a'ã€'--age'

å…¶ä¸­nameå¯¹åº”**ä½ç½®å‚æ•°**ï¼Œè€Œflagså¯¹åº”**å¯é€‰å‚æ•°**ï¼Œ**nameåœ¨å‘½ä»¤è¡Œå¿…é¡»è¾“å…¥ï¼Œå¹¶æŒ‰ç…§é¡ºåºå–‚ç»™ç¨‹åº**

å‘½ä»¤è¡Œä¼ å…¥å‚æ•°æ—¶ï¼Œå¯¹äºä½ç½®å‚æ•°æˆ‘ä»¬ç›´æ¥ç»™å‡ºå…¶å€¼ï¼Œå¯¹äºå¯é€‰å‚æ•°éœ€è¦ç»™å‡ºå…¶flagsã€‚**argparseä¼šå…ˆå°†å¯é€‰å‚æ•°è¿›è¡Œè§£æï¼Œå¯¹äºå‰©ä½™æœªè§£æçš„å‚æ•°ï¼Œä¼ ç»™ä½ç½®å‚æ•°**

```python
import argparse

parser = argparse.ArgumentParser(description='a test')
parser.add_argument('--age','-a')
parser.add_argument('myname')
parser.add_argument('sex')

# æ³¨æ„å‰ä¸¤ä¸ªå‚æ•°å¿…é¡»æ˜¯ mynameå’Œsex
args = parser.parse_args('tom boy --age 22'.split())

print(args) # Namespace(age='22', sex='boy', myname='tom')
```

å‘½ä»¤è¡Œä¼ å…¥å‚æ•°æ—¶ï¼Œå…ˆå†™ä½ç½®å‚æ•°ï¼Œå†å†™å¯é€‰å‚æ•°

> action: æŒ‡å®šäº†å‚æ•°æ˜¯å¦‚ä½•è¢«å¤„ç†çš„ï¼Œæ”¯æŒé¢æ“ä½œå¦‚ä¸‹

* storeï¼šè¿™ä¸ªåªæ˜¯ç®€å•çš„å­˜å‚¨è¿™ä¸ªå‚æ•°å€¼ï¼Œè¿™ä¹Ÿæ˜¯é»˜è®¤æ“ä½œ
* store_const: å­˜å‚¨constæŒ‡å®šçš„å€¼ï¼Œé…åˆconstå‚æ•°
* store_falseå’Œstore_true: åˆ†åˆ«å¯¹åº”å­˜å‚¨Falseå’ŒTrueå€¼ï¼Œå®ƒä»¬æ˜¯store_constçš„ç‰¹ä¾‹
* appendï¼šä¿å­˜ä¸ºåˆ—è¡¨æ ¼å¼ï¼Œå°†æ¯ä¸ªå‚æ•°çš„å€¼æ·»åŠ åˆ°è¿™ä¸ªåˆ—è¡¨

```python
import argparse


# action='store_const'  ä¼ å‚æ—¶åªè¦ä¼ å…¥å‚æ•°å,ä¼šé»˜è®¤é™„ä¸Šconst, å¦‚æœä¸ä¼ è¯¥å‚æ•°å, é»˜è®¤ä¸ºNone
parser=argparse.ArgumentParser()
parser.add_argument('--foo',action='store_const',const=42)
parser.parse_args('--foo'.split())
Out[0]: Namespace(foo=42)
parser.parse_args(''.split())
Out[1]: Namespace(foo=None)

# store_falseå’Œstore_true
# ä»¥store_falseä¸ºä¾‹, å½“ä¼ å…¥å‚æ•°åæ—¶, å€¼ä¸ºFalse, ä¸ä¼ å‚æ•°åæ—¶å€¼ä¸ºTrue
parser.add_argument('--bar', action='store_false')
parser.parse_args(''.split())
Out[2]: Namespace(bar=True, foo=None)
parser.parse_args('--bar'.split())
Out[3]: Namespace(bar=False, foo=None)

# action='append'
parser = argparse.ArgumentParser()
parser.add_argument('--foo', action='append')
parser.parse_args('--foo 1 --foo 2'.split())
Out[5]: Namespace(foo=['1', '2'])
```

> nargs: **nargsçš„æ„æ€å°±æ˜¯è¾“å…¥å‚æ•°çš„ä¸ªæ•°**

* Nâ€”**æŸæ­£æ•´æ•°**: æŒ‡å®šå¥½åï¼Œä¸èƒ½è¾“å…¥å¤šäº†ï¼Œä¹Ÿä¸èƒ½è¾“å…¥å°‘äº†
* '?': **è¿™æ—¶ä»£è¡¨parserä¼šè¯»å–0ä¸ªæˆ–1ä¸ªå‚æ•°ï¼Œå…·ä½“éµå¾ªä¸‹é¢çš„åŸåˆ™**ï¼š
  * å¦‚æœç»™å‡ºäº†1ä¸ªå‚æ•°ï¼Œç…§å¸¸è¯»å–è¿™ä¸ªå‚æ•°ä¿å­˜èµ·æ¥
  * å¦‚æœåªç»™å‡ºäº†flagsï¼Œæ¯”å¦‚â€˜--ageâ€™åé¢æœªç»™å‡ºå…·ä½“å€¼ï¼Œåˆ™ä¿å­˜constå‚æ•°çš„å€¼ï¼ˆå¦‚æœconstæœªç»™å‡ºåˆ™ä¸ºNoneï¼‰
  * å¦‚æœä»€ä¹ˆéƒ½æ²¡ç»™ï¼Œåˆ™ä¿å­˜defaultå‚æ•°çš„å€¼ï¼ˆå¦‚æœdefaultæœªç»™å‡ºåˆ™ä¸ºNoneï¼‰
* '\*':  ä¸ç¡®å®šå…·ä½“ä¸ªæ•°ï¼Œé‚£ä¹ˆå¯ä»¥ç”¨nargs=*
* '+': **è¦æ±‚å‚æ•°çš„ä¸ªæ•°å¿…é¡»å¤§äº**
  * å¦‚æœä¸ç»™flagsï¼Œparserä¼šç”¨defaultçš„å€¼ï¼›å¦‚æœåªç»™flagsï¼Œä¸ç»™å€¼ï¼Œæ­¤æ—¶ä¼šæŠ¥é”™
  * è€Œå½“nargs='*'æ—¶ï¼Œå°±ç®—åªç»™flagsä¸ç»™å€¼ï¼Œä¹Ÿä¸ä¼šæŠ¥é”™ï¼Œä¼šå¾—åˆ°ä¸€ä¸ªç©ºåˆ—è¡¨å‚æ•°


```python
import argparse

# nargs=?
parser = argparse.ArgumentParser(description='a test')
parser.add_argument('name')
parser.add_argument('--age','-a', nargs='?',const=16,default=18)

args = parser.parse_args('tom -a 15'.split())
print(args) # Namespace(age='15', name='tom')

args = parser.parse_args('tom -a'.split())
print(args) # Namespace(age=16, name='tom')

args = parser.parse_args('tom'.split())
print(args) # Namespace(age=18, name='tom')
```

> const: å¤šæ˜¯é…åˆå…¶å®ƒå‚æ•°å‡ºæ¼”çš„é…è§’

* actionå‚æ•°ä¸º 'store_const' æ—¶æˆ–æ˜¯ 'append_const' æ—¶
* nargså‚æ•°ä¸º '?' æ—¶

> default

å½“å‘½ä»¤è¡Œå®Œå…¨æ²¡æœ‰æåˆ°æŸä¸ªå‚æ•°æ—¶ï¼Œdefaultå‚æ•°å°±ä¼šå‘æŒ¥ä½œç”¨ï¼Œdefaultçš„é»˜è®¤å€¼ä¸ºNone

> type

è¿™ä¸ªç±»å‹å‚æ•°å¯ä»¥**çº¦æŸè¾“å…¥å‚æ•°çš„ç±»å‹**ï¼Œå½“ç±»å‹è½¬æ¢åˆæ³•æ—¶ï¼Œä¼š**è‡ªåŠ¨å¸®æˆ‘ä»¬è¿›è¡Œç±»å‹è½¬æ¢**

```python
import argparse

def str2bool(v):
    if v.lower() in ('yes', 'true', 't', 'y', '1'):
        return True
    elif v.lower() in ('no', 'false', 'f', 'n', '0'):
        return False
    else:
        raise argparse.ArgumentTypeError('Unsupported value encountered.')

# type=int
parser = argparse.ArgumentParser(description='a test')
parser.add_argument('name')
parser.add_argument('--age','-a',type=int, default='17')
args = parser.parse_args('tom'.split())
print(args) # Namespace(age=17, name='tom')

# è‡ªå®šä¹‰ç±»å‹
parser.add_argument('--is_del_aft', type=str2bool, default=False)
```

> choices

è¿™ä¸ªé€‰é¡¹å‚æ•°å¯ä»¥**ä½¿ç”¨åˆ—è¡¨çº¦æŸè¾“å…¥å‚æ•°çš„å–å€¼èŒƒå›´ã€‚**å¦‚æœè¾“å…¥å‚æ•°ä¸åœ¨å€™é€‰å‚æ•°åˆ—è¡¨ä¸­ï¼Œç¨‹åºä¼šæŠ¥é”™

```python
import argparse

parser = argparse.ArgumentParser(description='a test')
parser.add_argument('name',choices=['tom','Jim','Bob'])
parser.add_argument('--age','-a',type=int, default='17')

args = parser.parse_args('Jim'.split())
print(args) # Namespace(age=17, name='Jim')

args = parser.parse_args('Toy'.split())
print(args) # test.py: error: argument name: invalid choice: 'Toy' (choose from 'tom', 'Jim', 'Bob')
```

åœ¨å‚æ•°è·å–é˜¶æ®µï¼Œçº¦æŸå¥½ç”¨æˆ·è¾“å…¥çš„å‚æ•°èŒƒå›´ï¼Œå¯ä»¥é˜²æ­¢æ„æƒ³ä¸åˆ°çš„å‚æ•°å¸¦æ¥çš„æœªçŸ¥åæœ

> metavar: è¿™ä¸ªå‚æ•°çš„åŠŸèƒ½ä¹Ÿæ˜¯ä¸ªæ€§åŒ–æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯

```python
import argparse

parser = argparse.ArgumentParser(description='a test')
parser.add_argument('name',metavar='haha')

# åŠ metavar
parser.add_argument('--age','-a',type=int, default='17',metavar='hahahaha')
parser.parse_args('-h'.split())
>>> usage: pydevconsole.py [-h] [--age hahahaha] haha
a test
positional arguments:
  haha
optional arguments:
  -h, --help            show this help message and exit
  --age hahahaha, -a hahahaha


# ä¸åŠ metavar
parser.add_argument('--age','-a',type=int, default='17')
>>> usage: pydevconsole.py [-h] [--age AGE] haha
a test
positional arguments:
  haha
optional arguments:
  -h, --help         show this help message and exit
  --age AGE, -a AGE
```

> dest

æ¯ä¸ªå‚æ•°å¾…parserå¤„ç†å®Œæ¯•åï¼Œéƒ½ä¼šä»¥**â€˜å±æ€§å-å±æ€§â€™**çš„å½¢å¼ä¿å­˜èµ·æ¥

* å¯¹äºä½ç½®å‚æ•°ï¼Œå±æ€§åå°±æ˜¯ä½ç½®å‚æ•°çš„name

* å¯¹äºå¯é€‰å‚æ•°ï¼Œå±æ€§åæ˜¯å¯é€‰å‚æ•°å»æ‰â€˜--â€™åçš„é‚£éƒ¨åˆ†ï¼Œå¦‚æœæ²¡æœ‰â€˜--â€™ï¼Œåˆ™ä¸ºå»æ‰â€˜-â€™çš„é‚£éƒ¨åˆ†

ä¸ºäº†ä½¿å¾—å±æ€§ååˆæ³•ï¼Œparserè¿˜ä¼šå°†å•è¯**ä¸­é—´**çš„çŸ­æ¨ªæ å˜ä¸ºä¸‹åˆ’çº¿

ä½†å¦‚æœï¼Œä½ ä¸æƒ³ç”¨ä¸Šè¿°æ–¹æ³•è‡ªåŠ¨ç”Ÿæˆçš„å±æ€§åï¼Œä½ æƒ³è‡ªå·±æŒ‡å®šå±æ€§åï¼Œå°±å¯ä»¥è®¾å®šdestå‚æ•°æ¥æŒ‡å®šã€‚**ï¼ˆåªèƒ½æŒ‡å®šå¯é€‰å‚æ•°çš„å±æ€§åï¼‰**

```python
import argparse
# åˆ›å»º ArgumentParser å¯¹è±¡
parser = argparse.ArgumentParser(description='An example of using argparse')
# æ·»åŠ ä½ç½®å‚æ•°å’Œå¯é€‰å‚æ•°
parser.add_argument('--input', dest='input_file', help='Input file path')
parser.add_argument('--output', dest='output_file', help='Output file path')
# è§£æå‘½ä»¤è¡Œå‚æ•°
args = parser.parse_args('--input è¾“å…¥ --output è¾“å‡º'.split())
# è®¿é—®è§£æåçš„å‚æ•°å€¼
input_path = args.input_file
output_path = args.output_file
# æ‰§è¡Œç›¸åº”æ“ä½œ
print(f'Input file path: {input_path}')
print(f'Output file path: {output_path}')

>>>
Input file path: è¾“å…¥
Output file path: è¾“å‡º
```

å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœä¸æŒ‡å®šdestï¼Œå¹´é¾„çš„å±æ€§åæ˜¯ageã€‚è‹¥æ­¤æ—¶æŒ‡å®šäº†dest='myage'ï¼Œé‚£ä¹ˆå¹´é¾„çš„å±æ€§åå°±äººä¸ºè®¾å®šæˆäº†myage



### å®é™…ä¾‹å­

è„šæœ¬è¿è¡Œå‘½ä»¤`python script.py -gpus=0,1,2 --batch-size=10`ä¸­çš„`--batch-size`ä¼šè¢«è‡ªåŠ¨è§£ææˆ`batch_size`

`parser.add_argument` æ–¹æ³•çš„`type`å‚æ•°ç†è®ºä¸Šå¯ä»¥æ˜¯ä»»ä½•åˆæ³•çš„ç±»å‹ï¼Œä½†æœ‰äº›å‚æ•°ä¼ å…¥æ ¼å¼æ¯”è¾ƒéº»çƒ¦

* ä¾‹å¦‚listï¼Œæ‰€ä»¥ä¸€èˆ¬ä½¿ç”¨`bool`, `int`, `str`, `float`è¿™äº›åŸºæœ¬ç±»å‹å°±è¡Œäº†ï¼Œæ›´å¤æ‚çš„éœ€æ±‚å¯ä»¥é€šè¿‡`str`ä¼ å…¥ï¼Œç„¶åæ‰‹åŠ¨è§£æ

* `bool`ç±»å‹çš„è§£ææ¯”è¾ƒç‰¹æ®Šï¼Œä¼ å…¥ä»»ä½•å€¼éƒ½ä¼šè¢«è§£ææˆ`True`ï¼Œä¼ å…¥ç©ºå€¼æ—¶æ‰ä¸º`False

```python
import argparse


def str2bool(v):
    if v.lower() in ('yes', 'true', 't', 'y', '1'):
        return True
    elif v.lower() in ('no', 'false', 'f', 'n', '0'):
        return False
    else:
        raise argparse.ArgumentTypeError('Unsupported value encountered.')

    
if __name__ == '__main__':
    parser = argparse.ArgumentParser(description='manual to this script')
    parser.add_argument('--zook_host', type=str, default='127.0.0.1:2181')
    parser.add_argument('--num_of_task', type=int, default=10)
    parser.add_argument('--is_del_aft', type=str2bool, default=False)
    args = parser.parse_args()
    many_tasks_schedule_performance(zook_host=args.zook_host,
                                    num_of_task=args.num_of_task,
                                    is_del_aft=args.is_del_aft)
```

## tf.app.run

> tensorflowä¹Ÿæä¾›äº†ä¸€ç§æ–¹ä¾¿çš„è§£ææ–¹å¼
>

```python
import tensorflow as tf

tf.app.flags.DEFINE_string('gpus', None, 'gpus to use')
tf.app.flags.DEFINE_integer('batch_size', 5, 'batch size')

FLAGS = tf.app.flags.FLAGS


def main(_):
    print
    FLAGS.gpus
    print
    FLAGS.batch_size


if __name__ == "__main__":
    tf.app.run()


>>> python script.py --gpus=0,1,2 --batch_size=10
```

> æœ‰å‡ ç‚¹éœ€è¦æ³¨æ„

1. `tensorflow`åªæä¾›ä»¥ä¸‹å››ç§æ–¹æ³•ï¼š 
   `tf.app.flags.DEFINE_string`, `tf.app.flags.DEFINE_integer`, 

   `tf.app.flags.DEFINE_boolean`,  `tf.app.flags.DEFINE_float`

   åˆ†åˆ«å¯¹åº”`str`, `int`,`bool`,`float`ç±»å‹çš„å‚æ•°

   è¿™é‡Œå¯¹`bool`çš„è§£ææ¯”è¾ƒä¸¥æ ¼ï¼Œä¼ å…¥1ä¼šè¢«è§£ææˆ`True`ï¼Œå…¶ä½™ä»»ä½•å€¼éƒ½ä¼šè¢«è§£ææˆ`False`

2. è„šæœ¬ä¸­éœ€è¦å®šä¹‰ä¸€ä¸ªæ¥æ”¶ä¸€ä¸ªå‚æ•°çš„`main`æ–¹æ³•ï¼š`def main(_):`ï¼Œè¿™ä¸ªä¼ å…¥çš„å‚æ•°æ˜¯è„šæœ¬åï¼Œä¸€èˆ¬ç”¨ä¸åˆ°ï¼Œ æ‰€ä»¥ç”¨ä¸‹åˆ’çº¿æ¥æ”¶ã€‚

3. ä»¥`batch_size`å‚æ•°ä¸ºä¾‹ï¼Œä¼ å…¥è¿™ä¸ªå‚æ•°æ—¶ä½¿ç”¨çš„åç§°ä¸º`--batch_size`ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸­åˆ’çº¿ä¸ä¼šåƒåœ¨`argparse` ä¸­ä¸€æ ·è¢«è§£ææˆä¸‹åˆ’çº¿ã€‚

4. `tf.app.run()`ä¼šå¯»æ‰¾å¹¶æ‰§è¡Œå…¥å£è„šæœ¬çš„`main`æ–¹æ³•ã€‚ä¹Ÿåªæœ‰åœ¨æ‰§è¡Œäº†`tf.app.run()`ä¹‹åæ‰èƒ½ä»`FLAGS`ä¸­å–å‡ºå‚æ•°ã€‚ 
   ä»å®ƒçš„ç­¾åæ¥çœ‹ï¼Œå®ƒä¹Ÿæ˜¯å¯ä»¥è‡ªå·±æŒ‡å®šéœ€è¦æ‰§è¡Œçš„æ–¹æ³•çš„ï¼Œä¸ä¸€å®šéå¾—å«`main`ï¼š

   ```python
   run(main=None, argv=None)
   ```

5. `tf.app.flags`åªæ˜¯å¯¹`argpars`çš„ç®€å•å°è£…ã€‚

6. ä»£ç è§https://github.com/tensorflow/tensorflow/blob/r1.2/tensorflow/python/platform/flags.py



# ä½è¿ç®—

> èƒŒæ™¯çŸ¥è¯†

ğŸ…äºŒè¿›åˆ¶

åœ¨Pythonä¸­å¯ä»¥é€šè¿‡ä»¥"0b"æˆ–è€…"-0b"å¼€å¤´çš„å­—ç¬¦ä¸²æ¥è¡¨ç¤ºäºŒè¿›åˆ¶

```python
# è½¬äºŒè¿›åˆ¶
print(bin(5))
>>> 0b101
```

ğŸ¥¬åŸç ã€åç ã€è¡¥ç 

* **åŸç **: å°†ä¸€ä¸ªæ•´æ•°è½¬æ¢æˆ`äºŒè¿›åˆ¶`å½¢å¼ï¼Œå°±æ˜¯å…¶åŸç ã€‚ä¾‹å¦‚6çš„åŸç å°±æ˜¯`0110`ï¼›-18 çš„åŸç å°±æ˜¯`1000 0000 0001 0010`

  é€šä¿—çš„ç†è§£ï¼ŒåŸç å°±æ˜¯ä¸€ä¸ªæ•´æ•°æœ¬æ¥çš„äºŒè¿›åˆ¶å½¢å¼

* **åç **: å¯¹äºæ­£æ•°ï¼Œå®ƒçš„åç å°±æ˜¯å…¶åŸç (åŸç å’Œåç ç›¸åŒ)ï¼›è´Ÿæ•°çš„åç æ˜¯å°†åŸç ä¸­`é™¤ç¬¦å·ä½ä»¥å¤–`çš„æ‰€æœ‰ä½(æ•°å€¼ä½)å–å

* **è¡¥ç **: å¯¹äºæ­£æ•°ï¼Œå®ƒçš„è¡¥ç å°±æ˜¯å…¶åŸç (åŸç ã€åç ã€è¡¥ç éƒ½ç›¸åŒ)ï¼›è´Ÿæ•°çš„è¡¥ç æ˜¯å…¶åç åŠ 1

> ä½è¿ç®—

* **ä¸**: & æŒ‰ä½ä¸

* **æˆ–**: | æŒ‰ä½æˆ–

* **å**ï¼š~ æŒ‰ä½å–å

* **å¼‚æˆ–**: ^ æŒ‰ä½å¼‚æˆ–

* **æŒ‰ä½å·¦ç§»**: << æŒ‰ä½å·¦ç§»ï¼Œå„äºŒè¿›ä½å…¨éƒ¨å·¦ç§»nä½ï¼Œé«˜ä½ä¸¢å¼ƒï¼Œä½ä½è¡¥0

  å·¦ç§»1ä½ç›¸å½“äº ä¹˜ä»¥2

* **æŒ‰ä½å³ç§»**: >> æŒ‰ä½å³ç§»ï¼Œæ‰€æœ‰äºŒè¿›åˆ¶ä½å‘å³ç§»åŠ¨nä½ï¼Œç§»å‡ºçš„ä½åˆ æ‰ï¼Œè¿›çš„ä½è¡¥ç¬¦å·ä½ï¼Œå³ç§»ä¸ä¼šæ”¹å˜ä¸€ä¸ªæ•°çš„ç¬¦å·

  å³ç§»1ä½ç›¸å½“äº é™¤ä»¥2

> åº”ç”¨åœºæ™¯

1. åˆ¤æ–­å¥‡æ•°è¿˜æ˜¯å¶æ•°

   ä½¿ç”¨&è¿ç®—ï¼Œä¸1è¿›è¡Œ&ï¼Œå¦‚æœä¸º1ï¼Œé‚£ä¹ˆè¯¥æ•°ä¸ºå¥‡æ•°ï¼›å¦‚æœä¸º0ï¼Œé‚£ä¹ˆè¯¥æ•°æ˜¯å¶æ•°

2. äº¤æ¢ä¸¤ä¸ªæ•°å€¼

   ç¬¬ä¸€è¡Œï¼Œa = a ^ bï¼Œå¾ˆå®¹æ˜“ç†è§£

   ç¬¬äºŒè¡Œï¼Œ b = b ^ a = b ^ a ^ bï¼Œç”±äº b ^ b = 0ï¼Œæ‰€ä»¥ b = a ^ 0ï¼Œå³ b = a

   ç¬¬ä¸‰è¡Œï¼Œ a = a ^ b ,ç”±äºaåœ¨ç¬¬ä¸€æ­¥é‡æ–°èµ‹å€¼ï¼Œæ‰€ä»¥ï¼Œa =  a ^ b ^ a = bï¼Œå®Œæˆäº†æ•°å€¼äº¤æ¢

   ```python
   a ^= b
   b ^= a
   a ^= b
   ```

3. å¯»æ‰¾æ•°æ®åˆ—è¡¨ä¸­çš„ç‹¬ä¸€æ— äºŒ

   æœ‰ä¸€ä¸ªæ•°æ®åˆ—è¡¨ï¼ˆ2N+1ä¸ªæ•´æ•°ï¼‰ï¼Œåªæœ‰ä¸€ä¸ªæ•°å‡ºç°äº†1æ¬¡ï¼Œå…¶ä½™Nä¸ªæ•°éƒ½å‡ºç°äº†2æ¬¡ã€‚å¦‚ä½•æ‰¾åˆ°è¿™ä¸ªç‹¬ä¸€æ— äºŒçš„æ•°æ®

   ```python
   from functools import reduce
   lst = [1,5,6,4,2,6,4,2,1]
   reduce(lambda a,b : a^b, lst)
   
   >>> è¾“å‡º5
   ```

4. è®¡ç®—ä¸€ä¸ªæ•°å€¼çš„äºŒè¿›åˆ¶æ•°ä¸­æœ‰å¤šå°‘ä¸ª1

   ```python
   def count_ones(x):
       count = 0
       while x:
           count = count + 1
           x = x & (x-1) # ç­‰ä»·äº x = x & (x-1)
       return count
   ```

5. åœ¨ä¸€å †æ•°å­—ä¸­æ‰¾å‡ºåªå‡ºç°ä¸€æ¬¡çš„ä¸¤ä¸ªæ•°å­—

   ```python
   # æŸ¥æ‰¾æ„æˆresçš„ä¸¤ä¸ªæ•°
   def split_res(res, lst):
       tmp = 1
       num_0, num_1 = 0, 0
       while not tmp & res:
           tmp <<= 1
       for i in lst:
           if i & tmp:
               num_0 ^= i
           else:
               num_1 ^= i
       return num_0, num_1
   
   from functools import reduce
   lst = [1,5,6,4,2,6,4,2,1,7]
   res = reduce(lambda a,b : a^b, lst)
   num_0, num_1 = split_res(res, lst)
   ```
   

# è·¯å¾„

> [Pythonè·¯å¾„æ“ä½œæ¨¡å—pathlibï¼Œçœ‹è¿™ç¯‡å°±å¤Ÿäº†ï¼](https://zhuanlan.zhihu.com/p/475661402)

## pathlibå’Œoså¸¸ç”¨æ“ä½œå¯¹æ¯”

é€šè¿‡å¸¸ç”¨è·¯å¾„æ“ä½œçš„å¯¹æ¯”ï¼Œå¯ä»¥æ›´æ·±åˆ»ç†è§£pathlibå’Œosçš„åŒºåˆ«ï¼Œä¾¿äºåœ¨å®é™…æ“ä½œä¸­åšå¯¹ç…§ï¼Œä¹Ÿä¾¿äºè¿›è¡Œä½¿ç”¨æ›¿ä»£ï¼Œè¯¦ç»†å¯¹æ¯”å¦‚ä¸‹ï¼š

| pathlibæ“ä½œ            | osåŠos.pathæ“ä½œ      | åŠŸèƒ½æè¿°                                                     |
| ---------------------- | -------------------- | ------------------------------------------------------------ |
| Path.resolve()         | os.path.abspath()    | è·å¾—ç»å¯¹è·¯å¾„                                                 |
| Path.chmod()           | os.chmod()           | ä¿®æ”¹æ–‡ä»¶æƒé™å’Œæ—¶é—´æˆ³                                         |
| Path.mkdir()           | os.mkdir()           | åˆ›å»ºç›®å½•                                                     |
| Path.rename()          | os.rename()          | æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹é‡å‘½åï¼Œå¦‚æœè·¯å¾„ä¸åŒï¼Œä¼šç§»åŠ¨å¹¶é‡æ–°å‘½å           |
| Path.replace()         | os.replace()         | æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹é‡å‘½åï¼Œå¦‚æœè·¯å¾„ä¸åŒï¼Œä¼šç§»åŠ¨å¹¶é‡æ–°å‘½åï¼Œå¦‚æœå­˜åœ¨ï¼Œåˆ™ç ´åç°æœ‰ç›®æ ‡ã€‚ |
| Path.rmdir()           | os.rmdir()           | åˆ é™¤ç›®å½•                                                     |
| Path.unlink()          | os.remove()          | åˆ é™¤ä¸€ä¸ªæ–‡ä»¶                                                 |
| Path.unlink()          | os.unlink()          | åˆ é™¤ä¸€ä¸ªæ–‡ä»¶                                                 |
| Path.cwd()             | os.getcwd()          | è·å¾—å½“å‰å·¥ä½œç›®å½•                                             |
| Path.exists()          | os.path.exists()     | åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ–‡ä»¶æˆ–ç›®å½•name                                   |
| Path.home()            | os.path.expanduser() | è¿”å›ç”µè„‘çš„ç”¨æˆ·ç›®å½•                                           |
| Path.is_dir()          | os.path.isdir()      | æ£€éªŒç»™å‡ºçš„è·¯å¾„æ˜¯ä¸€ä¸ªæ–‡ä»¶                                     |
| Path.is_file()         | os.path.isfile()     | æ£€éªŒç»™å‡ºçš„è·¯å¾„æ˜¯ä¸€ä¸ªç›®å½•                                     |
| Path.is_symlink()      | os.path.islink()     | æ£€éªŒç»™å‡ºçš„è·¯å¾„æ˜¯ä¸€ä¸ªç¬¦å·é“¾æ¥                                 |
| Path.stat()            | os.stat()            | è·å¾—æ–‡ä»¶å±æ€§                                                 |
| PurePath.is_absolute() | os.path.isabs()      | åˆ¤æ–­æ˜¯å¦ä¸ºç»å¯¹è·¯å¾„                                           |
| PurePath.joinpath()    | os.path.join()       | è¿æ¥ç›®å½•ä¸æ–‡ä»¶åæˆ–ç›®å½•                                       |
| PurePath.name          | os.path.basename()   | è¿”å›æ–‡ä»¶å                                                   |
| PurePath.parent        | os.path.dirname()    | è¿”å›æ–‡ä»¶è·¯å¾„                                                 |
| Path.samefile()        | os.path.samefile()   | åˆ¤æ–­ä¸¤ä¸ªè·¯å¾„æ˜¯å¦ç›¸åŒ                                         |
| PurePath.suffix        | os.path.splitext()   | åˆ†ç¦»æ–‡ä»¶åå’Œæ‰©å±•å                                           |



# é…ç½®æ–‡ä»¶è§£è¯»

> [pythoné…ç½®æ–‡ä»¶INI/TOML/YAML/ENVçš„åŒºåˆ«](https://jiuaidu.com/jianzhan/1018523/)

## ini

**ini**æ–‡ä»¶å¯èƒ½æ˜¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨çš„æœ€ç›´æ¥çš„é…ç½®æ–‡ä»¶ã€‚**ini**æ–‡ä»¶éå¸¸é€‚åˆè¾ƒå°çš„é¡¹ç›®ï¼Œä¸»è¦æ˜¯å› ä¸ºè¿™äº›æ–‡ä»¶ä»…æ”¯æŒ1çº§æ·±çš„å±‚æ¬¡ç»“æ„ï¼Œ**ini**æ–‡ä»¶æœ¬è´¨ä¸Šæ˜¯å¹³é¢æ–‡ä»¶ï¼Œä½†å˜é‡å¯ä»¥å±äºç»„

```ini
[APP]
ENVIRONMENT = development
DEBUG = False

[DATABASE]
USERNAME: root
PASSWORD: p@ssw0rd
HOST: 127.0.0.1
PORT: 5432
DB: my_database

[LOGS]
ERRORS: logs/errors.log
INFO: data/info.log

[FILES]
STATIC_FOLDER: static
TEMPLATES_FOLDER: templates
```

pythonè§£æ**ini**æ–‡ä»¶ä»£ç å¦‚ä¸‹æ‰€ç¤º

```python
import configparser

config = configparser.ConfigParser()
path = r'Q:\pyCharmWS\object_detection\test.ini'
cfg = config.read(path)

# å¤šç§æ–¹å¼è·å–å€¼
config['DATABASE']['HOST']
Out[6]: '127.0.0.1'
config.get('DATABASE', 'HOST')
Out[7]: '127.0.0.1'
 
# è·å–æŒ‡å®šç±»å‹
config.getboolean('APP', 'DEBUG')
Out[8]: False
config.get('APP', 'DEBUG')
Out[9]: 'False'
```

**configparser**è¿˜æœ‰è®¸å¤šå…¶ä»–ç±»å‹æ£€æŸ¥æ–¹æ³•ï¼Œä¾‹å¦‚`getint()`ï¼Œ`getfloat()`ç­‰ç­‰



## toml

**TOML**æ–‡ä»¶ä¼¼ä¹ä¸**ini**æ–‡ä»¶å…±äº«_æŸäº›_è¯­æ³•ç›¸ä¼¼ä¹‹å¤„ï¼Œä½†æ”¯æŒæ›´å¹¿æ³›çš„æ•°æ®ç±»å‹ä»¥åŠå€¼æœ¬èº«ä¹‹é—´çš„å…³ç³»

å¦‚è¡¨ä¸­æ‰€ç¤ºï¼ŒTOMLæ”¯æŒ**åµŒå¥—è¡¨**çš„æ¦‚å¿µï¼Œè¯¥`[environments]`è¡¨åé¢å¸¦æœ‰å¤šä¸ªå­è¡¨ï¼Œé€šè¿‡ä½¿ç”¨ç‚¹ç¬¦å·ï¼Œæˆ‘ä»¬èƒ½å¤Ÿåˆ›å»ºè¡¨çš„å…³è”ï¼Œè¿™æ„å‘³ç€å®ƒä»¬æ˜¯åŒä¸€å…ƒç´ çš„ä¸åŒå®ä¾‹

```toml
# Keys
title = "My TOML Config"
# Tables
[project]
    name = "Faceback"
    description = "Powerful AI which renders the back of somebody's head, based on their face."
    version = "1.0.0"
    updated = 1979-05-27T07:32:00Z
    author = "Todd Birchard"
[database]
    host = "127.0.0.1"
    password = "p@ssw0rd"
    port = 5432
    name = "my_database"
    connection_max = 5000
    enabled = true

# Nested `tables`
[environments]
    [environments.dev]
        ip = "10.0.0.1"
        dc = "eqdc10"
    [environments.staging]
        ip = "10.0.0.2"
        dc = "eqdc10"
    [environments.production]
        ip = "10.0.0.3"
        dc = "eqdc10"

# Array of Tables
[[testers]]
    id = 1
    username = "JohnCena"
    password = "YouCantSeeMe69"
[[testers]]
    id = 3
    username = "TheRock"
    password = "CantCook123"
```

åŒæ ·æœ‰è¶£çš„æ˜¯æ¦‚å¿µ**è¡¨åˆ—**ï¼Œå¦‚ä¸‹è¡¨ä¸­çš„`[[testers]]`ï¼ŒåŒæ‹¬å·ä¸­çš„è¡¨ä¼šè‡ªåŠ¨æ·»åŠ åˆ°æ•°ç»„ä¸­ï¼Œå…¶ä¸­æ•°ç»„ä¸­çš„æ¯ä¸ªé¡¹ç›®éƒ½æ˜¯å…·æœ‰ç›¸åŒåç§°çš„è¡¨ï¼Œç­‰ä»·äºä¸‹ä¸‹é¢JSONæ‰€è¡¨è¾¾çš„ä¿¡æ¯

```json
{
	"testers": [{
			"id": 1,
			"username": "JohnCena",
			"password": "YouCantSeeMe69"
		},
		{
			"id": 2,
			"username": "TheRock",
			"password": "CantCook123"
		}
	]
}
```

pythonè§£ætomlçš„ä»£ç å¦‚ä¸‹

```python
import toml

path = r'Q:\pyCharmWS\object_detection\test.toml'
cfg = toml.load([path])

# Retrieving a dictionary
cfg['project']
cfg.get('project')

# Retrieving a value
cfg['project']['author']
cfg.get('project').get('author')

print(cfg)
{
	'title': 'My TOML Config',
	'project': {
		'name': 'Faceback',
		'description': "Powerful AI which renders the back of somebody's head, based on their face.",
		'version': '1.0.0',
		'updated': datetime.datetime(1979, 5, 27, 7, 32, tzinfo = < toml.tz.TomlTz object at 0x000001AE244933D0 > ),
		'author': 'Todd Birchard'
	},
	'database': {
		'host': '127.0.0.1',
		'password': 'p@ssw0rd',
		'port': 5432,
		'name': 'my_database',
		'connection_max': 5000,
		'enabled': True
	},
	'environments': {
		'dev': {
			'ip': '10.0.0.1',
			'dc': 'eqdc10'
		},
		'staging': {
			'ip': '10.0.0.2',
			'dc': 'eqdc10'
		},
		'production': {
			'ip': '10.0.0.3',
			'dc': 'eqdc10'
		}
	},
	'testers': [{
		'id': 1,
		'username': 'JohnCena',
		'password': 'YouCantSeeMe69'
	}, {
		'id': 3,
		'username': 'TheRock',
		'password': 'CantCook123'
	}]
}
```







## yaml





## ç³»ç»Ÿå˜é‡

```python
from os import environ

environ.get('ComSpec')
Out[0]: 'C:\\WINDOWS\\system32\\cmd.exe'
```



# æµ





